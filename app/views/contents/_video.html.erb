<%= simple_form_for content, url:histories_path, method:"POST" do |video|%>
	<input type="hidden" name="contents[content_id]" value="<%=content.id%>">
  <div class="player-container">
    <div class="embed-responsive embed-responsive-16by9"> 
      <div id="player"></div>
    </div> 
  </div>  

  <h3 class="title_video"><%= "#{content.title} #{content.experience} XP" %></h3>
  <p class="description"><%= content.description %></p>
  <%= video.submit "Próximo", class: "btn btn-default center-block"%>
<%end%>

<% content_for :js do %>
  <%= javascript_include_tag "notify.js" %>
<% end %>

<script type="text/javascript">
	// 2. This code loads the IFrame Player API code asynchronously.
	var tag = document.createElement('script');

	tag.src = "https://www.youtube.com/iframe_api";
	var firstScriptTag = document.getElementsByTagName('script')[0];
	firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  // 3. This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  var player;
  function onYouTubeIframeAPIReady() {
  	player = new YT.Player('player', {
      controls  : 0,
      videoId   : "<%= content.link.split(/\//).last %>",
  		playerVars: { 'showinfo':0, 'rel':'0' },
      events    : {
  			'onReady'      : onPlayerReady,
        'onStateChange': onPlayerStateChange
  		}
  	});
  }

  // 4. The API will call this function when the video player is ready.
  function onPlayerReady(event) {
  	//event.target.playVideo();
  }

  function onPlayerStateChange(event){
    if( event.data == YT.PlayerState.ENDED ){
      $.notify("Você ganhou " + "<%= content.experience %>" + " pontos de experiência!", "success");
      $('#points').html("Pontuação Atual: " + "<%= experience += content.experience %>" + "XP" );
      $('#icon_ok_<%=content.position%>').css('display','inline-block');
      $('#current_experience').html('XP: ' + '<%= current_user.performance.total_experience += content.experience %>');
    }
  }
</script>